@page "/editlibrary/{Id:int}"

@inject IJSRuntime JS


<PageTitle>TUAT - Edit Library</PageTitle>

<NavigationLock ConfirmExternalNavigation="true"
				OnBeforeInternalNavigation="OnBeforeInternalNavigation" />


<Tuat.LibraryEditor.Editor @ref="editor" Id="Id" />

@code {
	[Parameter]
	public int Id { get; set; }

	Tuat.LibraryEditor.Editor? editor = null;

	async Task OnBeforeInternalNavigation(LocationChangingContext context)
	{
		if (editor != null && (await editor.TextChanged()) == true)
		{
			var isConfirmed = await JS.InvokeAsync<bool>("confirm", "Changes are not saved. Are you sure you want to leave the page without saving changes?");

			if (!isConfirmed)
			{
				context.PreventNavigation();
			}
		}
	}
}
